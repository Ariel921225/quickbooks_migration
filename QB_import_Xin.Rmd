---
title: "Untitled"
author: "Siqi Wei"
date: "October 23, 2019"
output: html_document
---

```{r, warning=FALSE, message=FALSE}
library(readxl)
library(dplyr)
library(zoo)
data <- read_xlsx("../quick books donations.xlsx", col_names = FALSE)
```

```{r}
data <- data[,colSums(is.na(data)) < nrow(data)]

Date_col <- grep("Date", data)
Date_row <- which(data[,grep("Date", data)] == "Date")
```

```{r}
if(Date_row > 1) data<-data[-(1:Date_row-1),]

data <- data[,colSums(is.na(data)) < nrow(data)-1]

data[1,1]<-"full_name"
colnames(data) <- data[1,]
data <- data[-1,]
```

```{r}
t<-as.numeric(grep("Date", names(data)))-1

for(i in 1:t){
  data[,i]<- na.locf(data[,i],na.rm = F)
}

data <- data[which(!is.na(data[,"Date"])),] %>% 
  subset(select = -c(Balance)) %>% 
  subset(Amount >= 0)

payment_method<-c("check")
data2<-data.frame(data,payment_method)
```

```{r}
data2$Date<-as.Date(as.numeric(data$Date),origin="1899-12-30")
```
























